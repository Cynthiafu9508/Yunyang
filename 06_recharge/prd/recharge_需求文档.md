# 充值中心页面功能需求规格说明书

## 📖 文档信息
- **文档版本**: v1.0
- **创建日期**: 2025年10月16日
- **页面名称**: 充值中心页面 (recharge.html)
- **原型文件**: recharge.html
- **负责模块**: 商业化核心功能 - 会员订阅与心跳值充值

---

## 🎯 页面概述

### 产品定位
充值中心是云养APP的商业化核心页面，为用户提供会员订阅和心跳值充值服务，是APP主要的营收来源。通过清晰的套餐展示和便捷的支付流程，促进用户付费转化。

### 核心价值
- **会员订阅**: 提供周度/月度会员套餐，包含心跳值和人物创建额度
- **灵活充值**: 提供多档位心动充值方案，满足不同需求
- **透明展示**: 清晰展示当前余额和权益明细
- **快速支付**: 简化支付流程，提升转化率

---

## 👥 目标用户

### 主要用户群体

1. **核心付费用户** (18-35岁)
   - 高频使用APP，心跳值消耗快
   - 愿意为持续体验付费
   - 偏好月度会员套餐

2. **轻度付费用户** (16-30岁)
   - 偶尔使用，按需充值
   - 首选小额充值
   - 对价格敏感

3. **新用户试水** (全年龄段)
   - 首次体验付费功能
   - 倾向于最低价格档位
   - 需要清晰的权益说明

4. **重度用户** (25-40岁)
   - 长期稳定使用
   - 偏好长周期会员
   - 关注性价比

### 用户使用场景

- **心跳值耗尽**: 聊天时心跳值不足，被引导充值
- **主动充值**: 从个人中心主动进入充值
- **会员到期**: VIP会员到期前续费
- **促销活动**: 参与限时优惠活动
- **礼物赠送**: 为他人购买会员（未来功能）

---

## 🏗️ 功能架构

### 页面结构层次
```
充值中心页面
├── 导航栏
│   ├── 返回按钮
│   ├── 页面标题 "充值中心"
│   └── 占位空间
├── 当前余额卡片
│   ├── 心跳值余额（总计）
│   ├── VIP会员状态
│   └── 已创建人物数量
├── 套餐类型切换
│   ├── 会员套餐 Tab
│   └── 心动充值 Tab
├── 套餐列表区域
│   ├── 会员套餐区
│   │   ├── 周度会员卡片
│   │   └── 月度会员卡片
│   └── 心动充值区
│       ├── ¥3充值卡片
│       ├── ¥6充值卡片
│       └── ¥12充值卡片
└── 立即充值按钮（固定底部）
```

---

## ⚙️ 功能需求详述

### 1. 导航栏 (F-R-001)
**需求描述**: 提供页面标识和返回功能
**优先级**: P0 (必须实现)

**功能细节**:
- **返回按钮**:
  - 位置：左侧
  - 图标："← 返回"
  - 颜色：iOS蓝色 (#007AFF)
  - 点击行为：返回profile.html个人中心

- **页面标题**:
  - 文字："充值中心"
  - 位置：居中
  - 字体：18px，粗体
  - 颜色：深紫色 (#6a4c93)

- **占位空间**:
  - 右侧占位，保持标题居中

**验收标准**:
- [x] 返回按钮点击正确跳转
- [x] 标题居中显示
- [x] 导航栏与其他页面风格一致

---

### 2. 当前余额卡片 (F-R-002)
**需求描述**: 展示用户当前资产状态
**优先级**: P0 (必须实现)

**功能细节**:

#### 2.1 卡片设计
- **背景**: 紫色渐变（#667eea → #764ba2）
- **圆角**: 20px
- **阴影**: 0 8px 25px rgba(102, 126, 234, 0.3)
- **内边距**: 25px

#### 2.2 余额信息
**心跳值余额**:
- 标签："当前心跳值余额"
- 数值：大号字体（36px），粗体
- 格式：使用千分位分隔符
- 来源：heartBalance + dailyHeartBalance

**VIP会员状态**:
- 显示："💎 VIP会员至 2025-11-11"
- 字体：13px
- 颜色：白色，透明度90%

**已创建人物**:
- 显示："👤 已创建 X 个人物"
- 字体：13px
- 颜色：白色，透明度90%
- 数值来源：characterList.length

**验收标准**:
- [x] 余额实时同步localStorage
- [x] 包含永久和每日赠送心跳值总计
- [x] VIP状态正确显示
- [x] 人物数量准确
- [x] 充值成功后自动更新

---

### 3. 套餐类型切换 (F-R-003)
**需求描述**: 在会员套餐和心动充值间切换
**优先级**: P0 (必须实现)

**功能细节**:

#### 3.1 Tab设计
- **容器背景**: 白色半透明 (rgba(255, 255, 255, 0.9))
- **圆角**: 15px
- **内边距**: 5px
- **两个Tab**: "会员套餐" 和 "心动充值"

#### 3.2 Tab状态
**未选中状态**:
- 背景：透明
- 文字颜色：#a991b8（灰紫色）
- 字体：15px，粗体

**选中状态**:
- 背景：粉色渐变 (#ff9a9e → #fecfef)
- 文字颜色：白色
- 圆角：12px
- 阴影：0 4px 12px rgba(255, 154, 158, 0.3)
- 过渡动画：0.3s ease

#### 3.3 切换逻辑
- 点击Tab切换内容区域
- 默认显示"会员套餐"
- 切换时清除已选择的套餐
- 平滑过渡动画

**验收标准**:
- [x] Tab点击切换流畅
- [x] 选中状态视觉明确
- [x] 内容区域正确切换
- [x] 重置套餐选择状态

---

### 4. 会员套餐模块 (F-R-004)
**需求描述**: 展示周度和月度会员套餐
**优先级**: P0 (必须实现)

**功能细节**:

#### 4.1 周度会员 - ¥9.9
**套餐内容**:
- 价格：¥9.9
- 心跳值：1000次
- 人物创建：赠送3个额度
- VIP时长：7天

**权益展示**:
```
❤️ 1000次心跳值
👤 赠送3个人物创建额度
⚡ 专属VIP标识
```

**卡片设计**:
- 背景：白色半透明 (rgba(255, 255, 255, 0.95))
- 圆角：20px
- 内边距：20px
- 阴影：0 4px 20px rgba(106, 76, 147, 0.1)

#### 4.2 月度会员 - ¥19.9
**套餐内容**:
- 价格：¥19.9
- 心跳值：2500次
- 人物创建：赠送7个额度
- VIP时长：30天

**权益展示**:
```
❤️ 2500次心跳值
👤 赠送7个人物创建额度
⚡ 专属VIP标识
🎁 享受更多特权功能
```

#### 4.3 显示顺序
1. 周度会员（第一位）
2. 月度会员（第二位）

#### 4.4 交互状态
**默认状态**:
- 边框：2px solid transparent

**选中状态**:
- 边框颜色：#ff6b9d（粉色）
- 阴影增强：0 6px 25px rgba(255, 107, 157, 0.3)

**点击状态**:
- 缩小动画：scale(0.98)

**验收标准**:
- [x] 两个套餐显示完整
- [x] 价格和权益准确
- [x] 选中状态清晰
- [x] 点击反馈及时
- [x] 无推荐标记或特殊边框

---

### 5. 心动充值模块 (F-R-005)
**需求描述**: 提供三个固定档位的充值选项
**优先级**: P0 (必须实现)

**功能细节**:

#### 5.1 ¥3充值
- **价格**: ¥3
- **心跳值**: 200次
- **人物创建**: 赠送1个额度

#### 5.2 ¥6充值
- **价格**: ¥6
- **心跳值**: 500次
- **人物创建**: 赠送3个额度

#### 5.3 ¥12充值
- **价格**: ¥12
- **心跳值**: 1200次
- **人物创建**: 赠送7个额度

#### 5.4 卡片设计
与会员套餐卡片样式一致：
- 标题："心动充值"
- 价格显示：右上角大号数字
- 权益列表：图标+文字形式

#### 5.5 显示顺序
1. ¥3充值（第一位）
2. ¥6充值（第二位）
3. ¥12充值（第三位）

**验收标准**:
- [x] 三个档位全部显示
- [x] 价格和权益准确
- [x] 不支持自定义金额输入
- [x] 选中状态与会员套餐一致

---

### 6. 立即充值按钮 (F-R-006)
**需求描述**: 确认充值并处理支付
**优先级**: P0 (必须实现)

**功能细节**:

#### 6.1 按钮设计
- **位置**: 固定在页面底部
- **背景**: 白色半透明 (rgba(255, 255, 255, 0.95))
- **内边距**: 15px 20px 30px
- **按钮样式**:
  - 粉色渐变 (#ff9a9e → #fecfef)
  - 圆角：25px
  - 宽度：100%
  - 高度：16px padding
  - 文字："立即充值"，18px粗体

#### 6.2 按钮状态
**可点击状态**:
- 不透明度：1
- 阴影：0 6px 20px rgba(255, 154, 158, 0.4)

**禁用状态**:
- 不透明度：0.5
- 鼠标样式：not-allowed
- 条件：未选择任何套餐

**点击状态**:
- 下压动画：translateY(2px)
- 阴影减弱：0 4px 15px

#### 6.3 充值逻辑

**步骤1：验证选择**
```javascript
if (!selectedPackage) {
    alert('请选择一个套餐');
    return;
}
```

**步骤2：显示确认弹窗**
```
确认购买XXX套餐？

价格：¥XX
获得：
• XXX次心跳值
• X个人物创建额度
• XX天VIP会员（仅会员套餐）
```

**步骤3：处理支付**
- 更新localStorage中的heartBalance（增加永久心跳值）
- 更新localStorage中的createQuota（增加创建额度）
- 更新页面显示余额

**步骤4：成功提示**
```
充值成功！

您已获得：
❤️ XXX次心跳值（永久）
👤 X个人物创建额度

当前总余额：XXX 心跳值
剩余创建额度：X 个
```

**步骤5：返回页面**
- 延迟2秒后自动跳转到profile.html
- 跳转后余额自动同步

**验收标准**:
- [x] 未选择套餐时禁用
- [x] 确认弹窗信息准确
- [x] 充值成功后数据正确更新
- [x] 页面余额实时更新
- [x] 2秒后自动返回
- [x] 充值记录到localStorage

---

## 💾 数据存储方案

### localStorage数据操作

#### 读取数据
```javascript
{
  // 读取当前余额
  heartBalance: parseInt(localStorage.getItem('heartBalance')),
  dailyHeartBalance: parseInt(localStorage.getItem('dailyHeartBalance')),
  
  // 读取人物信息
  characterList: JSON.parse(localStorage.getItem('characterList')),
  characterCount: characterList.length,
  
  // 读取创建额度
  createQuota: parseInt(localStorage.getItem('createQuota'))
}
```

#### 更新数据（充值成功）
```javascript
{
  // 更新永久心跳值
  heartBalance: currentBalance + purchasedHearts,
  
  // 更新创建额度
  createQuota: currentQuota + purchasedCharacters,
  
  // 充值类型标记（会员/充值）
  lastPurchaseType: 'vip' | 'recharge',
  
  // 充值时间
  lastPurchaseTime: new Date().toISOString()
}
```

---

## 💰 套餐定价策略

### 会员套餐对比
| 套餐 | 价格 | 心跳值 | 人物额度 | 时长 | 单位价格 |
|------|------|--------|----------|------|----------|
| 周度 | ¥9.9 | 1000 | 3 | 7天 | ¥0.0099/心跳 |
| 月度 | ¥19.9 | 2500 | 7 | 30天 | ¥0.0080/心跳 |

**价值分析**:
- 月度会员单位价格更优惠（↓19%）
- 适合高频用户长期订阅

### 心动充值对比
| 档位 | 价格 | 心跳值 | 人物额度 | 单位价格 |
|------|------|--------|----------|----------|
| 小额 | ¥3 | 200 | 1 | ¥0.015/心跳 |
| 中档 | ¥6 | 500 | 3 | ¥0.012/心跳 |
| 大额 | ¥12 | 1200 | 7 | ¥0.010/心跳 |

**价值分析**:
- 充值金额越大，单位价格越低
- 鼓励用户选择更大档位

---

## 🎨 UI/UX设计要求

### 视觉风格

#### 色彩系统
- **主背景**: 渐变粉紫色 (#f0e5ff → #d9c6e0)
- **余额卡片**: 紫色渐变 (#667eea → #764ba2)
- **套餐卡片**: 白色半透明毛玻璃效果
- **强调色**: 粉红色渐变 (#ff9a9e → #fecfef)
- **文字主色**: 深紫色 (#6a4c93)

#### 排版规范
- **页面标题**: 18px，粗体
- **余额数值**: 36px，粗体
- **价格数值**: 32px，粗体
- **套餐名称**: 20px，粗体
- **权益文字**: 14px，常规
- **辅助文字**: 13px，常规

### 交互设计

#### 反馈机制
- **点击反馈**: 卡片缩小动画
- **选中反馈**: 粉色边框高亮
- **加载状态**: 按钮文字变化
- **成功反馈**: 弹窗提示

#### 动画效果
- **Tab切换**: 0.3s ease过渡
- **卡片点击**: scale(0.98) 变换
- **按钮点击**: translateY(2px) 下压
- **内容切换**: fade in/out

### 响应式设计
- **桌面端**: iPhone 16尺寸（393×852px）
- **移动端**: 全屏适配，移除边框
- **滚动优化**: 流畅滚动，固定底部按钮

---

## 🔄 用户流程

### 充值完整流程
```
用户进入充值页面
    ↓
查看当前余额和会员状态
    ↓
选择套餐类型（会员/充值）
    ↓
浏览套餐选项
    ↓
点击选择某个套餐
    ↓
卡片高亮，显示选中状态
    ↓
点击"立即充值"按钮
    ↓
弹窗确认套餐内容
    ↓
用户确认
    ↓
处理支付（模拟）
    ↓
更新localStorage数据
    ↓
页面余额实时更新
    ↓
显示充值成功提示
    ↓
2秒后自动返回个人中心
    ↓
个人中心余额同步更新
```

### 充值取消流程
```
用户选择套餐
    ↓
点击"立即充值"
    ↓
弹窗确认
    ↓
用户点击"取消"
    ↓
关闭弹窗
    ↓
保持在充值页面
    ↓
已选套餐保持选中状态
```

---

## ✅ 验收标准总览

### 功能完整性
- [x] 导航栏返回功能正常
- [x] 余额卡片信息准确完整
- [x] Tab切换流畅无误
- [x] 2个会员套餐显示正确
- [x] 3个充值档位显示正确
- [x] 套餐选择状态清晰
- [x] 充值按钮状态正确
- [x] 充值流程完整可用

### 数据准确性
- [x] 余额读取localStorage正确
- [x] 充值后数据更新准确
- [x] 返回后余额同步
- [x] 会员状态正确显示
- [x] 人物数量准确

### 交互体验
- [x] 页面加载流畅
- [x] Tab切换动画流畅
- [x] 卡片点击反馈及时
- [x] 充值成功提示友好
- [x] 自动返回时机合理

### 视觉效果
- [x] 梦女风格统一
- [x] 渐变效果美观
- [x] 卡片阴影层次清晰
- [x] 选中状态明显
- [x] 响应式适配良好

---

## 🚀 后续迭代计划

### v1.1 计划功能
- [ ] 支付渠道集成（微信支付、支付宝）
- [ ] 充值记录查询
- [ ] 发票功能
- [ ] 优惠券系统

### v1.2 计划功能
- [ ] 限时折扣活动
- [ ] 首充优惠
- [ ] 礼物赠送功能
- [ ] 充值排行榜

### v1.3 计划功能
- [ ] 自动续费功能
- [ ] 套餐升级/降级
- [ ] 充值提醒
- [ ] VIP特权详情页

---

## 🧪 测试用例

### 基础功能测试

#### TC-R-001: 页面加载
- **前置条件**: 用户已登录
- **操作步骤**: 从个人中心点击"订阅充值"
- **预期结果**: 
  - 页面正常加载
  - 余额卡片显示当前数据
  - 默认显示会员套餐Tab

#### TC-R-002: Tab切换
- **前置条件**: 充值页面已加载
- **操作步骤**: 
  1. 点击"心动充值"Tab
  2. 点击"会员套餐"Tab
- **预期结果**:
  - Tab状态正确切换
  - 内容区域对应切换
  - 动画流畅

#### TC-R-003: 套餐选择
- **前置条件**: 在会员套餐Tab
- **操作步骤**: 点击周度会员卡片
- **预期结果**:
  - 卡片显示粉色边框
  - 其他卡片取消选中
  - 充值按钮可用

#### TC-R-004: 会员套餐充值
- **前置条件**: 已选择月度会员
- **操作步骤**:
  1. 点击"立即充值"
  2. 确认弹窗
- **预期结果**:
  - 显示正确的套餐信息
  - 确认后heartBalance增加2500
  - createQuota增加7
  - 显示成功提示
  - 2秒后返回个人中心

#### TC-R-005: 心动充值
- **前置条件**: 切换到心动充值Tab
- **操作步骤**:
  1. 选择¥6充值
  2. 点击充值并确认
- **预期结果**:
  - heartBalance增加500
  - createQuota增加3
  - 页面余额实时更新

### 边界条件测试

#### TC-R-006: 未选择套餐充值
- **操作步骤**: 不选择任何套餐直接点击充值
- **预期结果**: 
  - 按钮禁用或
  - 弹窗提示"请选择一个套餐"

#### TC-R-007: 充值取消
- **操作步骤**: 
  1. 选择套餐
  2. 点击充值
  3. 确认弹窗点击取消
- **预期结果**:
  - 关闭弹窗
  - 不更新数据
  - 保持在充值页面

#### TC-R-008: 返回按钮
- **操作步骤**: 点击左上角返回按钮
- **预期结果**: 
  - 跳转到profile.html
  - 不影响已选择的套餐状态

### 数据同步测试

#### TC-R-009: 余额同步
- **操作步骤**:
  1. 在充值页面充值
  2. 返回个人中心
- **预期结果**: 个人中心余额与充值页面一致

#### TC-R-010: 跨页面数据一致性
- **操作步骤**:
  1. 充值后返回个人中心
  2. 进入聊天页面
- **预期结果**: 所有页面心跳值显示一致

---

## 📝 变更记录

### v1.0 (2025-10-16)
- 初始版本
- 实现会员套餐模块（周度/月度）
- 实现心动充值模块（¥3/¥6/¥12）
- 移除自定义充值功能
- 移除推荐标记
- 实现完整充值流程
- 数据与profile.html、chat.html打通

---

## 📧 联系方式

如有疑问或建议，请联系：
- 邮箱：support@yunyang.com
- 微信：yunyang_service
- 工作时间：9:00-18:00

---

**文档版本**: v1.0
**创建日期**: 2025年10月16日
**维护者**: 云养产品团队

