# 忘记密码功能产品需求文档 (PRD)

## 文档信息
- **文档版本**: v1.0
- **创建日期**: 2025年8月27日
- **最后更新**: 2025年8月27日
- **Flutter实现**: ✅ 已完成
- **产品经理**: Cynthia
- **优先级**: P0

## 产品概述

### 功能描述
忘记密码功能允许用户通过手机号验证码验证身份后重新设置密码，确保账号安全性的同时提供便捷的密码重置服务。

### 业务价值
- 解决用户忘记密码的痛点，降低用户流失率
- 通过验证码验证确保账号安全
- 提供完整的密码重置流程，提升用户体验
- 支持密码强度检测，提高账号安全性

### 用户分析
- **主要用户**: 忘记密码的已注册用户
- **使用场景**: 用户无法登录时选择忘记密码
- **用户需求**: 安全、快速、便捷地重置密码

## 功能架构

### 页面层级
```
密码登录页面
    ↓ 点击"忘记密码？"
忘记密码页面 (手机号输入)
    ↓ 发送验证码
验证码验证页面
    ↓ 验证成功
密码重置页面
    ↓ 重置成功
登录页面
```

### 功能模块
1. **手机号输入**: 输入需要重置密码的手机号
2. **验证码发送**: 发送验证码到指定手机号
3. **验证码验证**: 输入并验证6位验证码
4. **密码重置**: 设置新密码并确认
5. **成功反馈**: 显示重置成功信息

## 功能需求详述

### 1. 忘记密码页面

#### 1.1 页面导航
**功能描述**: 页面左上角显示返回按钮，点击可返回上一页面

**业务规则**:
- 点击返回按钮应回到密码登录页面
- 返回操作应保持用户已输入的手机号信息

**交互规范**:
- 按钮样式由设计师决定
- 点击反馈由设计师决定

#### 1.2 页面标题
**功能描述**: 页面顶部显示"忘记密码"标题

**业务规则**:
- 标题应清晰可见，体现页面功能

**交互规范**:
- 标题样式、尺寸规格由设计师决定
- 建议: 使用主题色，字体加粗，仅供设计师参考

#### 1.3 说明文字
**功能描述**: 页面中显示功能说明文字

**业务规则**:
- 说明文字应清晰描述功能流程
- 文字内容："请输入您注册时使用的手机号，我们将发送验证码帮您重置密码"

**交互规范**:
- 文字样式、尺寸规格由设计师决定
- 建议: 居中对齐，使用主题色，仅供设计师参考

#### 1.4 手机号输入框
**功能描述**: 用户输入需要重置密码的手机号

**业务规则**:
- 默认显示"+86"国家代码，固定不可更改
- 限制只能输入数字
- 最大长度11位
- 必填项验证
- 格式验证：必须是11位手机号

**交互规范**:
- 输入框样式、尺寸规格由设计师决定
- 建议: 圆角设计，半透明背景，仅供设计师参考
- 错误提示: "手机号格式不正确，请输入11位手机号"

#### 1.5 发送验证码按钮
**功能描述**: 用户点击发送验证码的按钮

**业务规则**:
- 点击前验证手机号格式
- 发送过程中显示加载状态
- 发送成功后启动60秒倒计时
- 倒计时期间按钮不可点击

**交互规范**:
- 按钮样式、尺寸规格由设计师决定
- 建议: 渐变色彩，圆角设计，体现梦女风格，仅供设计师参考
- 加载状态: 显示"发送中..."文字和加载动画
- 倒计时状态: 显示"重新发送 (XXs)"

### 2. 验证码验证页面

#### 2.1 页面标题
**功能描述**: 页面顶部显示"验证身份"标题

**业务规则**:
- 标题应清晰可见，体现页面功能

**交互规范**:
- 标题样式、尺寸规格由设计师决定

#### 2.2 说明文字
**功能描述**: 显示验证码发送信息

**业务规则**:
- 显示手机号信息（部分隐藏）
- 文字内容："验证码已发送至 +86 123 ***** 123"

**交互规范**:
- 文字样式、尺寸规格由设计师决定

#### 2.3 验证码输入框
**功能描述**: 用户输入6位验证码

**业务规则**:
- 6个独立的数字输入框
- 自动跳转到下一个输入框
- 支持删除操作
- 验证码格式：6位数字
- 验证失败次数限制：最多3次

**交互规范**:
- 输入框样式、尺寸规格由设计师决定
- 建议: 圆角设计，聚焦时显示边框，仅供设计师参考
- 自动跳转：输入完成后自动跳转到下一个输入框

#### 2.4 重新发送按钮
**功能描述**: 用户重新发送验证码的按钮

**业务规则**:
- 60秒倒计时期间不可点击
- 倒计时结束后可重新发送
- 发送成功后重新启动倒计时

**交互规范**:
- 按钮样式由设计师决定
- 倒计时状态: 显示"重新发送 (XXs)"
- 可点击状态: 显示"重新发送"

#### 2.5 提示文字
**功能描述**: 显示验证码有效期提示

**业务规则**:
- 文字内容："验证码有效期为5分钟，请及时输入"

**交互规范**:
- 文字样式由设计师决定

### 3. 密码重置页面

#### 3.1 页面标题
**功能描述**: 页面顶部显示"设置新密码"标题

**业务规则**:
- 标题应清晰可见，体现页面功能

**交互规范**:
- 标题样式、尺寸规格由设计师决定

#### 3.2 说明文字
**功能描述**: 显示密码设置说明

**业务规则**:
- 文字内容："请设置您的新密码，建议使用字母、数字和符号的组合"

**交互规范**:
- 文字样式、尺寸规格由设计师决定

#### 3.3 新密码输入框
**功能描述**: 用户输入新密码

**业务规则**:
- 默认隐藏密码内容
- 提供显示/隐藏密码的切换按钮
- 必填项验证
- 密码长度验证：最少6位
- 实时密码强度检测

**交互规范**:
- 输入框样式、尺寸规格由设计师决定
- 建议: 与手机号输入框保持一致的设计风格，仅供设计师参考
- 错误提示: "密码长度不能少于6位"

#### 3.4 密码强度指示器
**功能描述**: 显示密码强度等级

**业务规则**:
- 实时检测密码强度
- 强度等级：弱、中、强
- 根据强度显示不同颜色

**交互规范**:
- 指示器样式由设计师决定
- 强度颜色：弱(红色)、中(橙色)、强(绿色)

#### 3.5 确认密码输入框
**功能描述**: 用户确认新密码

**业务规则**:
- 默认隐藏密码内容
- 提供显示/隐藏密码的切换按钮
- 必填项验证
- 密码一致性验证

**交互规范**:
- 输入框样式、尺寸规格由设计师决定
- 错误提示: "两次输入的密码不一致"

#### 3.6 确认修改按钮
**功能描述**: 用户确认修改密码的按钮

**业务规则**:
- 点击前验证所有必填项
- 验证密码一致性
- 修改过程中显示加载状态
- 修改成功后显示成功弹窗

**交互规范**:
- 按钮样式、尺寸规格由设计师决定
- 建议: 渐变色彩，圆角设计，体现梦女风格，仅供设计师参考
- 加载状态: 显示"修改中..."文字和加载动画

### 4. 成功反馈

#### 4.1 成功弹窗
**功能描述**: 显示密码重置成功信息

**业务规则**:
- 显示成功图标和文字
- 提供"立即登录"按钮
- 点击后跳转到登录页面

**交互规范**:
- 弹窗样式由设计师决定
- 成功图标：绿色对勾图标
- 成功文字："密码重置成功！"

## 技术实现

### Flutter实现状态
- ✅ 忘记密码页面基础结构
- ✅ 手机号输入验证
- ✅ 验证码发送功能
- ✅ 验证码验证页面
- ✅ 6位验证码输入框
- ✅ 验证码验证逻辑
- ✅ 密码重置页面
- ✅ 密码强度检测
- ✅ 密码确认验证
- ✅ 成功反馈弹窗
- ✅ 页面间导航
- ✅ 页面动画效果

### 文件路径
- `flutter_app/lib/screens/forgot_password_screen.dart`
- `flutter_app/lib/screens/forgot_password_verify_screen.dart`
- `flutter_app/lib/screens/forgot_password_reset_screen.dart`

### 测试验证码
- 测试验证码：`123456`

## 验收标准

### 功能验收
- [ ] 忘记密码页面能正确显示和输入手机号
- [ ] 发送验证码功能正常工作
- [ ] 验证码验证页面能正确输入6位验证码
- [ ] 验证码验证逻辑正确（测试码123456）
- [ ] 密码重置页面能正确设置新密码
- [ ] 密码强度检测功能正常
- [ ] 密码确认验证功能正常
- [ ] 成功弹窗正确显示
- [ ] 页面间导航流畅

### 用户体验验收
- [ ] 页面加载动画流畅
- [ ] 输入验证反馈及时
- [ ] 错误提示信息清晰
- [ ] 按钮点击反馈明显
- [ ] 验证码输入自动跳转
- [ ] 倒计时功能正常
- [ ] 密码强度实时检测
- [ ] 页面响应速度良好

### 安全验收
- [ ] 手机号格式验证正确
- [ ] 验证码验证逻辑安全
- [ ] 密码强度检测有效
- [ ] 验证失败次数限制
- [ ] 倒计时防重复发送

## 后续优化

### 功能增强
1. **生物识别验证**: 支持指纹/面容识别验证
2. **邮箱验证**: 支持邮箱验证码重置密码
3. **安全问题**: 支持安全问题验证
4. **登录历史**: 显示最近登录记录

### 安全增强
1. **验证码加密**: 验证码传输加密
2. **IP限制**: 限制异常IP访问
3. **设备验证**: 新设备登录验证
4. **异常检测**: 检测异常重置行为

### 用户体验优化
1. **智能填充**: 支持密码管理器自动填充
2. **语音验证**: 支持语音验证码
3. **多语言支持**: 支持多语言界面
4. **无障碍支持**: 支持无障碍访问 